/*********************************************************************************************************
* 模块名称: 
* 摘    要: 
* 当前版本: 1.0.0
* 作    者: SZLY(COPYRIGHT 2018 SZLY. All rights reserved.)
* 完成日期: 2018年01月01日 
* 内    容:
* 注    意: none                                                                  
**********************************************************************************************************
* 取代版本: 
* 作    者:
* 完成日期: 
* 修改内容:
* 修改文件: 
*********************************************************************************************************/

/*********************************************************************************************************
*                                              包含头文件
*********************************************************************************************************/
#include "IWDG.h"
#include "stm32f10x_conf.h"
#include "stm32f10x_iwdg.h"
/*********************************************************************************************************
*                                              宏定义
*********************************************************************************************************/

/*********************************************************************************************************
*                                              内部变量
*********************************************************************************************************/
 
/*********************************************************************************************************
*                                              内部函数声明
*********************************************************************************************************/
static void ConfigIWDG(u8 prer, u16 rlr);
/*********************************************************************************************************
*                                              内部函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称: 
* 函数功能: 
* 输入参数: 
* 输出参数: 
* 返 回 值: 
* 创建日期: 2018年01月01日
* 注    意:
*********************************************************************************************************/
static void ConfigIWDG(u8 prer, u16 rlr){
  IWDG_WriteAccessCmd(IWDG_WriteAccess_Enable);   //*(unsigned int*)(0x40003000) = 0x5555;

  IWDG_SetPrescaler(prer);                        //*(unsigned int*)(0x40003004) = 0x04;

  IWDG_SetReload(rlr);                            //*(unsigned int*)(0x40003008) = 624;

  IWDG_ReloadCounter();                           //*(unsigned int*)(0x40003000) = 0xAAAA;

  IWDG_Enable();                                  //*(unsigned int*)(0x40003000) = 0xCCCC;
}
/*********************************************************************************************************
*                                              API函数实现
*********************************************************************************************************/
/*********************************************************************************************************
* 函数名称: 
* 函数功能: 
* 输入参数: 
* 输出参数: 
* 返 回 值: 
* 创建日期: 2018年01月01日
* 注    意:
*********************************************************************************************************/
void InitIWDG(void){
  ConfigIWDG(IWDG_Prescaler_64, 624);
}

void FeedIWDG(void){

  IWDG_ReloadCounter();
}

