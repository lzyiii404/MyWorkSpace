#include <stdio.h>
#include "platform.h"
#include "xil_printf.h"
#include "xparameters.h"
#include "xled_state.h"
#include "sleep.h"

#define LED_IP_DEVICE_ID	XPAR_LED_STATE_0_DEVICE_ID

XLed_state LED;
XLed_state_Config *LEDConfig;


int main()
{
    init_platform();

    print("Hello World\n\r");

    LEDConfig = XLed_state_LookupConfig(LED_IP_DEVICE_ID);
    XLed_state_CfgInitialize(&LED, LEDConfig);

    XLed_state_Set_total_cnt(&LED, 10000);
    int i = 0;
    int op = 0;
    while(1){
    	switch (op){
    		case 0 :
    			if(i < 10000)
    				i += 500;
    			else
    				op = 1;
    			break;

    		case 1:
    			if(i > 0)
    				i -= 500;
    			else
    				op = 0;
    			break;
    		default:
    			break;
    	}
    	XLed_state_Set_high_cnt(&LED, i);
    }

    cleanup_platform();
    return 0;
}
